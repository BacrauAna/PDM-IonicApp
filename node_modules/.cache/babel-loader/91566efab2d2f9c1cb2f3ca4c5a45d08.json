{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Anisoara Bacrau\\\\Desktop\\\\an3\\\\PDM\\\\ionic\\\\PDM-IonicApp\\\\src\\\\todo\\\\BeautyList.tsx\";\nimport React, { useContext, useState, useEffect } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport { useNetwork } from \"../utils/useNetwork\";\nimport { IonContent, IonFab, IonFabButton, IonHeader, IonIcon, IonLoading, IonPage, IonTitle, IonToolbar, IonButton, IonInfiniteScroll, IonInfiniteScrollContent, IonSelect, IonSelectOption, IonSearchbar, createAnimation } from \"@ionic/react\";\nimport { add } from \"ionicons/icons\";\nimport Beauty from \"./Beauty\";\nimport { getLogger } from \"../core\";\nimport { BeautyContext } from \"./BeautyProvider\";\nimport { AuthContext } from \"../auth/AuthProvider\";\nconst log = getLogger(\"BeautyList\");\n\nconst BeautyList = ({\n  history\n}) => {\n  const {\n    beauties,\n    fetching,\n    fetchingError,\n    updateServer\n  } = useContext(BeautyContext);\n  const [disableInfiniteScroll, setDisableInfiniteScroll] = useState(false);\n  const {\n    networkStatus\n  } = useNetwork();\n  const [filter, setFilter] = useState(undefined);\n  const [search, setSearch] = useState(\"\");\n  const [pos, setPos] = useState(20);\n  const selectOptions = [\"no\", \"yes\"];\n  const [beautiesShow, setBeautiesShow] = useState([]);\n  const {\n    logout\n  } = useContext(AuthContext);\n\n  const handleLogout = () => {\n    logout === null || logout === void 0 ? void 0 : logout();\n    return /*#__PURE__*/React.createElement(Redirect, {\n      to: {\n        pathname: \"/login\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 16\n      }\n    });\n  };\n\n  log(\"render\");\n\n  async function searchNext($event) {\n    if (beauties && pos < beauties.length) {\n      setBeautiesShow([...beautiesShow, ...beauties.slice(pos, 21 + pos)]);\n      setPos(pos + 17);\n    } else {\n      setDisableInfiniteScroll(true);\n    }\n\n    await $event.target.complete();\n  } //update server when network status is back online\n\n\n  useEffect(() => {\n    if (networkStatus.connected === true) {\n      updateServer && updateServer();\n    }\n  }, [networkStatus.connected]); //pagination\n\n  useEffect(() => {\n    if (beauties === null || beauties === void 0 ? void 0 : beauties.length) {\n      setBeautiesShow(beauties.slice(0, 20));\n    }\n  }, [beauties]);\n  useEffect(() => {\n    if (filter && beauties) {\n      const boolType = filter === \"yes\";\n      setBeautiesShow(beauties.filter(beauty => beauty.ocupat === boolType));\n    }\n  }, [filter]); //search\n\n  useEffect(() => {\n    if (search && beauties) {\n      setBeautiesShow(beauties.filter(beauty => beauty.data.startsWith(search)));\n    }\n  }, [search]);\n\n  function simpleAnimation() {\n    const el = document.querySelector(\".networkStatus\");\n\n    if (el) {\n      const animation = createAnimation().addElement(el).duration(1000).direction(\"alternate\").iterations(Infinity).keyframes([{\n        offset: 0,\n        transform: \"scale(1)\",\n        opacity: \"1\"\n      }, {\n        offset: 1,\n        transform: \"scale(0.95)\",\n        opacity: \"1\"\n      }]);\n      animation.play();\n    }\n  }\n\n  useEffect(simpleAnimation, []);\n\n  function groupAnimations() {\n    const elem1 = document.querySelector('.searchBar');\n    const elem2 = document.querySelector('.select');\n\n    if (elem1 && elem2) {\n      const animation1 = createAnimation().addElement(elem1).fromTo('transform', 'scale(0.8)', 'scale(1)');\n      const animation2 = createAnimation().addElement(elem2).fromTo('transform', 'scale(1)', 'scale(0.8)');\n      const parentAnimation = createAnimation().duration(600).direction(\"alternate\").iterations(3).addAnimation([animation1, animation2]);\n      parentAnimation.play();\n    }\n  }\n\n  useEffect(groupAnimations, []);\n  return /*#__PURE__*/React.createElement(IonPage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonToolbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonTitle, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 21\n    }\n  }, \"Beauties List\"), /*#__PURE__*/React.createElement(IonButton, {\n    shape: \"round\",\n    slot: \"end\",\n    onClick: handleLogout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 21\n    }\n  }, \"LOGOUT\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"networkStatus\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }, \"Network is: \", /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 33\n    }\n  }, networkStatus.connected ? \"online\" : \"offline\"))), /*#__PURE__*/React.createElement(IonContent, {\n    fullscreen: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLoading, {\n    isOpen: fetching,\n    message: \"Fetching beauties\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"searchBar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonSearchbar, {\n    value: search,\n    debounce: 1000,\n    onIonChange: e => setSearch(e.detail.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"select\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonSelect, {\n    value: filter,\n    placeholder: \"Selection about disponibility\",\n    onIonChange: e => setFilter(e.detail.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 17\n    }\n  }, selectOptions.map(option => /*#__PURE__*/React.createElement(IonSelectOption, {\n    key: option,\n    value: option,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 25\n    }\n  }, option)))), beautiesShow && beautiesShow.map(beauty => {\n    return /*#__PURE__*/React.createElement(Beauty, {\n      key: beauty._id,\n      _id: beauty._id,\n      data: beauty.data,\n      ora: beauty.ora,\n      servicii: beauty.servicii,\n      nrPersoane: beauty.nrPersoane,\n      nume: beauty.nume,\n      ocupat: beauty.ocupat,\n      status: beauty.status,\n      photoPath: beauty.photoPath,\n      latitude: beauty.latitude,\n      longitude: beauty.longitude,\n      onEdit: id => history.push(`/beauty/${id}`),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 25\n      }\n    });\n  }), /*#__PURE__*/React.createElement(IonInfiniteScroll, {\n    threshold: \"100px\",\n    disabled: disableInfiniteScroll,\n    onIonInfinite: e => searchNext(e),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonInfiniteScrollContent, {\n    loadingText: \"Loading more good beauties...\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 21\n    }\n  })), fetchingError && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 21\n    }\n  }, fetchingError.message || \"Failed to fetch beauties\"), /*#__PURE__*/React.createElement(IonFab, {\n    vertical: \"bottom\",\n    horizontal: \"end\",\n    slot: \"fixed\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(IonFabButton, {\n    onClick: () => history.push(\"/beauty\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(IonIcon, {\n    icon: add,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 25\n    }\n  })))));\n};\n\nexport default BeautyList;","map":{"version":3,"sources":["C:/Users/Anisoara Bacrau/Desktop/an3/PDM/ionic/PDM-IonicApp/src/todo/BeautyList.tsx"],"names":["React","useContext","useState","useEffect","Redirect","useNetwork","IonContent","IonFab","IonFabButton","IonHeader","IonIcon","IonLoading","IonPage","IonTitle","IonToolbar","IonButton","IonInfiniteScroll","IonInfiniteScrollContent","IonSelect","IonSelectOption","IonSearchbar","createAnimation","add","Beauty","getLogger","BeautyContext","AuthContext","log","BeautyList","history","beauties","fetching","fetchingError","updateServer","disableInfiniteScroll","setDisableInfiniteScroll","networkStatus","filter","setFilter","undefined","search","setSearch","pos","setPos","selectOptions","beautiesShow","setBeautiesShow","logout","handleLogout","pathname","searchNext","$event","length","slice","target","complete","connected","boolType","beauty","ocupat","data","startsWith","simpleAnimation","el","document","querySelector","animation","addElement","duration","direction","iterations","Infinity","keyframes","offset","transform","opacity","play","groupAnimations","elem1","elem2","animation1","fromTo","animation2","parentAnimation","addAnimation","e","detail","value","map","option","_id","ora","servicii","nrPersoane","nume","status","photoPath","latitude","longitude","id","push","message"],"mappings":"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","sourcesContent":["import React, {useContext,useState, useEffect} from \"react\";\r\nimport { RouteComponentProps } from \"react-router\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { useNetwork } from \"../utils/useNetwork\";\r\nimport {\r\n    IonContent,\r\n    IonFab,\r\n    IonFabButton,\r\n    IonHeader,\r\n    IonIcon,\r\n    IonLoading,\r\n    IonPage,\r\n    IonTitle,\r\n    IonToolbar,\r\n    IonButton,\r\n    IonInfiniteScroll,\r\n    IonInfiniteScrollContent,\r\n    IonSelect,\r\n    IonSelectOption,\r\n    IonSearchbar,\r\n    createAnimation,\r\n} from \"@ionic/react\";\r\nimport { add } from \"ionicons/icons\";\r\nimport Beauty from \"./Beauty\";\r\nimport { getLogger } from \"../core\";\r\nimport { BeautyContext } from \"./BeautyProvider\";\r\nimport { AuthContext } from \"../auth/AuthProvider\";\r\nimport { BeautyProps } from \"./BeautyProps\";\r\n\r\nconst log = getLogger(\"BeautyList\");\r\n\r\nconst BeautyList: React.FC<RouteComponentProps> = ({ history }) => {\r\n    const { beauties, fetching, fetchingError, updateServer } = useContext(BeautyContext);\r\n    const [disableInfiniteScroll, setDisableInfiniteScroll] = useState<boolean>(\r\n        false\r\n    );\r\n    const { networkStatus } = useNetwork();\r\n    const [filter, setFilter] = useState<string | undefined>(undefined);\r\n    const [search, setSearch] = useState<string>(\"\");\r\n    const [pos, setPos] = useState(20);\r\n    const selectOptions = [\"no\", \"yes\"];\r\n    const [beautiesShow, setBeautiesShow] = useState<BeautyProps[]>([]);\r\n    const { logout } = useContext(AuthContext);\r\n    const handleLogout = () => {\r\n        logout?.();\r\n        return <Redirect to={{ pathname: \"/login\" }} />;\r\n    };\r\n    log(\"render\");\r\n\r\n\r\n    async function searchNext($event: CustomEvent<void>) {\r\n        if (beauties && pos < beauties.length) {\r\n            setBeautiesShow([...beautiesShow, ...beauties.slice(pos, 21 + pos)]);\r\n            setPos(pos + 17);\r\n        } else {\r\n            setDisableInfiniteScroll(true);\r\n        }\r\n        await ($event.target as HTMLIonInfiniteScrollElement).complete();\r\n    }\r\n\r\n    //update server when network status is back online\r\n    useEffect(() => {\r\n        if (networkStatus.connected === true) {\r\n            updateServer && updateServer();\r\n        }\r\n    }, [networkStatus.connected]);\r\n\r\n    //pagination\r\n    useEffect(() => {\r\n        if (beauties?.length) {\r\n            setBeautiesShow(beauties.slice(0, 20));\r\n        }\r\n    }, [beauties]);\r\n\r\n    useEffect(() => {\r\n        if (filter && beauties) {\r\n            const boolType = filter === \"yes\";\r\n            setBeautiesShow(beauties.filter((beauty) => beauty.ocupat === boolType));\r\n        }\r\n    }, [filter]);\r\n\r\n    //search\r\n    useEffect(() => {\r\n        if (search && beauties) {\r\n            setBeautiesShow(beauties.filter((beauty) => beauty.data.startsWith(search)));\r\n        }\r\n    }, [search]);\r\n\r\n    function simpleAnimation() {\r\n        const el = document.querySelector(\".networkStatus\");\r\n        if (el) {\r\n            const animation = createAnimation()\r\n                .addElement(el)\r\n                .duration(1000)\r\n                .direction(\"alternate\")\r\n                .iterations(Infinity)\r\n                .keyframes([\r\n                    { offset: 0, transform: \"scale(1)\", opacity: \"1\" },\r\n                    {\r\n                        offset: 1,\r\n                        transform: \"scale(0.95)\",\r\n                        opacity: \"1\",\r\n                    },\r\n                ]);\r\n            animation.play();\r\n        }\r\n    }\r\n    useEffect(simpleAnimation, []);\r\n\r\n    function groupAnimations() {\r\n        const elem1 = document.querySelector('.searchBar');\r\n        const elem2 = document.querySelector('.select');\r\n        if (elem1 && elem2) {\r\n            const animation1 = createAnimation()\r\n                .addElement(elem1)\r\n                .fromTo('transform', 'scale(0.8)','scale(1)');\r\n            const animation2 = createAnimation()\r\n                .addElement(elem2)\r\n                .fromTo('transform', 'scale(1)', 'scale(0.8)');\r\n            const parentAnimation = createAnimation()\r\n                .duration(600)\r\n                .direction(\"alternate\")\r\n                .iterations(3)\r\n                .addAnimation([animation1, animation2]);\r\n            parentAnimation.play();    }\r\n    }\r\n    useEffect(groupAnimations, []);\r\n\r\n\r\n    return (\r\n        <IonPage>\r\n            <IonHeader>\r\n                <IonToolbar>\r\n                    <IonTitle>Beauties List</IonTitle>\r\n                    <IonButton shape=\"round\" slot=\"end\" onClick={handleLogout}>LOGOUT</IonButton>\r\n                    {/*<IonButton  onClick={handleLogout}>Logout</IonButton>*/}\r\n                </IonToolbar>\r\n                <div className=\"networkStatus\">\r\n                    Network is: <b>{networkStatus.connected ? \"online\" : \"offline\"}</b>\r\n                </div>\r\n            </IonHeader>\r\n            <IonContent fullscreen>\r\n                <IonLoading isOpen={fetching} message=\"Fetching beauties\" />\r\n                <div className=\"searchBar\">\r\n                <IonSearchbar\r\n                    value={search}\r\n                    debounce={1000}\r\n                    onIonChange={(e) => setSearch(e.detail.value!)}\r\n                ></IonSearchbar>\r\n                </div>\r\n                <div className=\"select\">\r\n                <IonSelect\r\n                    value={filter}\r\n                    placeholder=\"Selection about disponibility\"\r\n                    onIonChange={(e) => setFilter(e.detail.value)}\r\n                >\r\n                    {selectOptions.map((option) => (\r\n                        <IonSelectOption key={option} value={option}>\r\n                            {option}\r\n                        </IonSelectOption>\r\n                    ))}\r\n                </IonSelect>\r\n                </div>\r\n                {beautiesShow &&\r\n                beautiesShow.map((beauty: BeautyProps) => {\r\n                    return (\r\n                        <Beauty\r\n                            key={beauty._id}\r\n                            _id={beauty._id}\r\n                            data={beauty.data}\r\n                            ora={beauty.ora}\r\n                            servicii={beauty.servicii}\r\n                            nrPersoane={beauty.nrPersoane}\r\n                            nume={beauty.nume}\r\n                            ocupat={beauty.ocupat}\r\n                            status={beauty.status}\r\n                            photoPath={beauty.photoPath}\r\n                            latitude={beauty.latitude}\r\n                            longitude={beauty.longitude}\r\n                            onEdit={(id) => history.push(`/beauty/${id}`)}\r\n                        />\r\n                    );\r\n                })}\r\n                <IonInfiniteScroll\r\n                    threshold=\"100px\"\r\n                    disabled={disableInfiniteScroll}\r\n                    onIonInfinite={(e: CustomEvent<void>) => searchNext(e)}\r\n                >\r\n                    <IonInfiniteScrollContent loadingText=\"Loading more good beauties...\"></IonInfiniteScrollContent>\r\n                </IonInfiniteScroll>\r\n                {fetchingError && (\r\n                    <div>{fetchingError.message || \"Failed to fetch beauties\"}</div>\r\n                )}\r\n                <IonFab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\">\r\n                    <IonFabButton onClick={() => history.push(\"/beauty\")}>\r\n                        <IonIcon icon={add} />\r\n                    </IonFabButton>\r\n                </IonFab>\r\n            </IonContent>\r\n        </IonPage>\r\n    );\r\n};\r\n\r\nexport default BeautyList;\r\n\r\n"]},"metadata":{},"sourceType":"module"}